<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" href="./style.css">

</head>
<body>
    <div class="container">
        <h1 class="my-5">Sign Me</h1>
        <div class="d-flex cont-full sub-cont">
            

            <div class="my-3 pe-3 col-lg-3">
                <div class="my-3">
                    <label for="background" class="me-2">Background Color</label>
                    <input type="color" id="background" class="up-btns" value="#ffffff" onchange="background()">
                </div>
                <div class="my-3">
                    <label for="sign" class="sign-label">Signature Color</label>
                    <input type="color" id="sign" class="up-btns" value="#003230" onchange="fontcolor()">
                </div>
                <div class="d-flex my-3">
                    <label for="dropdownInput" class="fn-size">Font Size</label>
                    <div class="dropdown" >
                        <button class="btn btn-secondary dropdown-toggle size-btn" type="button" data-bs-toggle="dropdown" aria-expanded="true" value="5px" id="dropdownInput">
                          5px
                        </button>
                        <ul class="dropdown-menu up-btns">
                            <li><a class="dropdown-item" onclick="selectOption('10px')">10px</a></li>
                            <li><a class="dropdown-item" onclick="selectOption('20px')">20px</a></li>
                            <li><a class="dropdown-item" onclick="selectOption('30px')">30px</a></li>
                        </ul>
                    </div>

                    <!-- <div class="dropdown" id="drop">
                        <button class="btn btn-secondary dropdown-toggle" type="button" value="5px" id="dropdownInput" onclick="toggleOption()">
                          5px
                        </button>
                        <ul id="dropdownList" class="dropdown-menu">
                          <li><a class="dropdown-item" onclick="selectOption('10px')">10px</a></li>
                          <li><a class="dropdown-item" onclick="selectOption('20px')">20px</a></li>
                          <li><a class="dropdown-item" onclick="selectOption('30px')">30px</a></li>
                        </ul>
                    </div> -->
                </div>
                <div class="d-flex flex-column my-3">
                    <div class="my-2">                    
                       <button type="button" class="btn btn-primary btns" id="clearBtn">clear</button>
                    </div>
                    <div class="my-2">
                        <button type="button" class="btn btn-secondary btns" id="savedownBtn">save and download</button>
                    </div>
        
                    <div class="my-2">
                        <button type="button" class="btn btn-warning btns" id="preBtn">Retrieve previous signature</button>
                    </div>
                </div>
        
            </div>
            



            <canvas class="col-lg-9 ps-0 pe-3" name="signarea" id="sign-area" width="800" height="400">

            </canvas>
          
        </div> 
        
    </div>
</body>

<script>
    const bg_code = document.getElementById("background");
    const fc_code = document.getElementById("sign");
    const fontsize = document.getElementById("dropdownInput");

    const canvas = document.getElementById("sign-area");
    const clear = document.getElementById("clearBtn");
    const save = document.getElementById("savedownBtn");
    const re = document.getElementById("preBtn");

    let canv = canvas.getContext("2d");

    function selectOption(option){
        fontsize.value = option;
        fontsize.innerHTML = option
    }

    fc_code.addEventListener('change', (e)=>{
        canv.strokeStyle = e.target.value;
        canv.fillStyle = e.target.value;
    })

    bg_code.addEventListener('change', (e)=>{
        canv.fillStyle = e.target.value;
        canv.fillRect(0,0,800,400);
    })

    fontsize.addEventListener('change', (e)=>{
        canv.lineWidth = e.target.value;
    })

    canvas.addEventListener('mousedown', (e) =>{
        isDrawing = true;
        lastX = event.offsetX;
        lastY = event.offsetY;
        
    })

    canvas.addEventListener('mousemove', (e)=>{
        if(isDrawing){
            canv.beginPath();
            canv.moveTo(lastX, lastY);
            canv.lineTo(event.offsetX, event.offsetY);
            canv.stroke();

            lastX = event.offsetX;
            lastY = event.offsetY;
        }
    })

    canvas.addEventListener('mouseup', (e)=>{
        isDrawing = false;
    })


    clear.addEventListener('click', (e)=> {
        canv.clearRect(0,0,canvas.width,canvas.height);
    })

    save.addEventListener('click', (e)=>{
        localStorage.setItem('SignaturedItems', canvas.toDataURL());

        let link = document.createElement('a');

        link.download = 'my-canvas.png';

        link.href = canvas.toDataURL();

        link.click();
    })

    re.addEventListener('click', (e)=>{
        let savedSign = localStorage.getItem('SignaturedItems');

        if (savedSign){
            let img = new Image;
            img.src = savedSign;
            canv.drawImage(img,0,0);
        
        }
    })
    




</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</html>